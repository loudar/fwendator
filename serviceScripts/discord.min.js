async function Z(){console.log("⚙️ Initializing...");try{let j;if(window.webpackChunkdiscord_app?.push([[Symbol()],{},(D)=>j=D]),!j||!j.c){let D=window.prompt("Could not automatically access Discord internals. Please paste your Discord token:","");if(D&&D.trim())return D.trim();throw Error("Webpack runtime not available. Are you running this on discord.com?")}let E=Object.values(j.c).find((D)=>{try{return D?.exports?.default?.getToken!==void 0}catch(K){return!1}})?.exports?.default?.getToken?.();if(!E){let D=window.prompt("Could not automatically find your token. Please paste your Discord token:","");if(D&&D.trim())return D.trim();throw Error("Token not provided.")}return E}catch(j){console.error("Failed to get token:",j);let z=window.prompt("Failed to get token automatically. Please paste your Discord token:","");if(z&&z.trim())return z.trim();throw j}}async function V(j,z){let B=await fetch(j,{headers:{Authorization:z}});if(!B.ok){let E=await B.text().catch(()=>"");throw Error(`Request failed ${B.status} ${B.statusText} for ${j}: ${E}`)}return B.json()}async function _(j){console.log("✉️ Fetching friends...");let z=await V("https://discord.com/api/v9/users/@me/relationships",j);return Object.values(z).map((B)=>B.user)}var $=(j)=>new Promise((z)=>setTimeout(z,j));async function y(j,z){let B=Math.floor(j.length/60),E=j.length%60;console.log(`⏱ This will take about ${B>0?B+(B===1?" minute and ":" minutes and "):""}${E>0?E+(E===1?" second":" seconds"):""}`);let D={},K=0;for(let H of j){K+=1;let{id:L,avatar:Q}=H,W=Q?`https://cdn.discordapp.com/avatars/${L}/${Q}.webp?size=128`:"",X=await V(`https://discord.com/api/v9/users/${L}/relationships`,z);D[L]={name:`${H.username}#${H.discriminator}`,avatarUrl:W,mutual:Object.values(X).map((Y)=>Y.id)},console.log(`\uD83D\uDCC3 Parsing friends... [${K}/${j.length}]`),await $(1000)}return D}function A(j){document.head.innerHTML="",document.body.innerHTML="",document.body.appendChild(Object.assign(document.createElement("h1"),{innerHTML:"Your friends data ✨"})),document.body.appendChild(Object.assign(document.createElement("textarea"),{value:JSON.stringify(j,null,2),readOnly:!0,style:"width: 100%; height: 400px;"})),document.body.appendChild(Object.assign(document.createElement("button"),{innerHTML:"\uD83D\uDCC4 Download data",onclick:function(){let z=URL.createObjectURL(new Blob([JSON.stringify(j)],{type:"application/json"}));Object.assign(document.createElement("a"),{href:z,download:`friends-${new Date().toISOString().replace(/[:T]/g,"-").slice(0,19).replaceAll("-","")}.json`}).click(),URL.revokeObjectURL(z)}}))}async function C(){try{if(!window.location.hostname.endsWith("discord.com")){alert("Not on discord.com — open this in Discord's web app page.");return}let z=await Z(),B=await _(z),E=await y(B,z);A(E),console.log("✨ Done")}catch(j){console.error(j),alert(`Failed: ${j?.message||j}`)}}C();
